<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Board Database</title>
  <style>
    body { margin:0; padding:20px; font-family: monospace; background:#f5f5f5; }
    h2 { margin-top:0; }
    #board-data { white-space: pre-wrap; word-wrap: break-word; background: #fff; padding:10px; border:1px solid #ccc; }
  </style>
  <script>
    // load stored board from localStorage
    let boardData = JSON.parse(localStorage.getItem('boardData') || '{}');
    if (!boardData.notes) boardData.notes = [];
    if (!boardData.chatMessages) boardData.chatMessages = [];
    if (!boardData.archives) boardData.archives = [];

    function displayBoardData() {
      const pre = document.getElementById('board-data');
      pre.textContent = JSON.stringify(boardData, null, 2);
    }

    // handle messages from index.html
    window.addEventListener('message', event => {
      try {
        const msg = event.data;
        if (msg && msg.type === 'SAVE_BOARD') {
          boardData = msg.boardData;
          localStorage.setItem('boardData', JSON.stringify(boardData));
          displayBoardData();
        }
        else if (msg && msg.type === 'REQUEST_BOARD') {
          // send current data back to requester
          event.source.postMessage({ type: 'BOARD_DATA', boardData }, event.origin);
        }
      } catch (e) {
        console.warn('DB frame error processing message:', e);
      }
    });

    window.addEventListener('load', displayBoardData);
  </script>
</head>
<body>
  <h2>Stored Board Data</h2>
  <pre id="board-data">Loadingâ€¦</pre>
</body>
</html>